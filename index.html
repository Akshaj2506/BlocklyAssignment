<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Blockly- Assignment</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="blockly-editor">
      <div id="blocklyDiv" height="100%" width="480"></div>
    </div>
    <div id="output-container"></div>
    <div id="button-container">
      <button onclick="runCode()" id="run-button">Run JavaScript</button>
      <a href="https://github.com/Akshaj2506/BlocklyAssignment" target="_blank">Click here for the program code</a>
    </div>
    <script src="https://unpkg.com/blockly"></script>
    <script src="blocks.js"></script>
    <script src="main.js"></script>
    <script>
      window.onload = alert("Hello user! Just drag and drop the custom blocks in the white area and edit the configurations and click on 'Run JavaScript' button. Top and left attribute is for changing the position of the shapes on the screen");  
      const toolbox = {
        kind: "flyoutToolbox",
        contents: [
          {
            kind: "block",
            type: "controls_repeat_ext",
            inputs: {
              TIMES: {
                shadow: {
                  type: "math_number",
                  fields: {
                    NUM: 5,
                  },
                },
              },
            },
          },
          {
            kind: "block",
            type: "circle",
          },
          {
            kind: "block",
            type: "rectangle",
          },
          {
            kind: "block",
            type: "triangle",
          },
        ],
      };
      var workspace = Blockly.inject("blocklyDiv", {
        toolbox: toolbox,
        scrollbars: false,
      });
      function runCode() {
        const outputContainer = document.getElementById("output-container");
        window.LoopTrap = 1000;
        Blockly.JavaScript.INFINITE_LOOP_TRAP =
          'if (--window.LoopTrap == 0) throw "Infinite Loop.";\n';
        var code = Blockly.JavaScript.workspaceToCode(workspace);
        Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
        try {
          if (outputContainer.children.length != 0) {
            outputContainer.innerHTML = "";
          }
          eval(code);
        } catch (e) {
          alert(e);
        }
      }
    </script>
  </body>
</html>
